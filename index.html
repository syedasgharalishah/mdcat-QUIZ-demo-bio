<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Day 8 Quiz - EDUCATION DEPARTMENT SCREENING TEST PREPARATION – June 26, 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* General Body Styling */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F9FA; /* Very light gray */
            color: #2C3E50; /* Main text color */
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh; /* Full viewport height */
            overflow-x: hidden; /* Prevent horizontal scrolling */
        }

        /* Top Bar Styling */
        .top-bar {
            background-color: #ffffff;
            border-bottom: 1px solid #e0e0e0;
            padding: 0.75rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .top-bar .date-display {
            color: #6D6875;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .top-bar .whatsapp-link {
            color: #6D6875;
            text-decoration: none;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Header Section Styling */
        .header-section {
            background-color: #ffffff;
            padding: 1.5rem 1rem;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            margin-bottom: 1rem;
        }

        .quiz-title {
            font-family: 'Roboto', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            color: #2C3E50;
            margin-bottom: 1rem;
        }

        .progress-bar-container {
            width: 80%;
            max-width: 600px;
            height: 10px;
            background-color: #e0e0e0;
            border-radius: 5px;
            margin: 1rem auto;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(to right, #20B2AA, #3EB489); /* Teal to Mint Green */
            border-radius: 5px;
            transition: width 0.3s ease-in-out;
        }

        .banner-logo {
            max-width: 200px;
            height: auto;
            border-radius: 8px;
            margin-top: 1rem;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .credits {
            font-size: 0.85rem;
            color: #6D6875;
            margin-top: 0.5rem;
        }

        /* Card Styling (for login, quiz, results pages) */
        .card {
            background-color: #FFF5EE; /* PeachPuff - very light, warm tone */
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            padding: 1.5rem;
            margin: 1rem auto;
            max-width: 700px;
            width: 90%;
            box-sizing: border-box;
        }

        /* Button Styling */
        .button-gradient {
            background-image: linear-gradient(to right, #E6E6FA, #FFDAB9); /* Lavender to PeachPuff - light and attractive */
            color: #2C3E50; /* Dark text for contrast */
            font-weight: bold;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            cursor: pointer;
            border: none;
        }

        .button-gradient:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        .button-gradient:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .option-button {
            background-color: #ffffff;
            border: 1px solid #ddd; /* Light border */
            padding: 0.75rem 1rem;
            border-radius: 8px;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-bottom: 0.75rem;
            color: #2C3E50;
            font-weight: normal;
        }

        .option-button:hover:not(.selected) {
            background-color: #f0f0f0; /* Slightly darker on hover */
        }

        .option-button.selected {
            border-color: #6D6875; /* Medium gray for selected */
            background-color: #f0f0f0;
            font-weight: bold;
        }

        .option-button.correct {
            background-color: #90EE90; /* LightGreen */
            border-color: #28a745; /* Darker green border */
            animation: pulse-green 0.5s ease-out forwards;
        }

        .option-button.incorrect {
            background-color: #FF6B6B; /* Light Red */
            border-color: #dc3545; /* Darker red border */
            animation: shake-red 0.5s ease-out forwards;
        }

        /* Special Question Styling */
        .special-question {
            border: 3px solid #FFD700; /* Gold border */
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.5); /* Glowing effect */
        }

        /* Explanation Section Styling */
        .explanation {
            background-color: #e0f7fa; /* Light Cyan */
            border-left: 5px solid #20B2AA; /* Teal border */
            padding: 1rem;
            margin-top: 1rem;
            border-radius: 8px;
            color: #2C3E50;
            font-size: 0.9rem;
            display: none; /* Hidden by default */
        }

        /* Timer and Progress Display */
        .timer-display {
            font-size: 1.2rem;
            font-weight: bold;
            color: #2C3E50;
            margin-bottom: 1rem;
            text-align: center;
        }

        .question-progress {
            font-size: 1rem;
            color: #6D6875;
            margin-bottom: 1rem;
            text-align: center;
        }

        /* Animations */
        @keyframes pulse-green {
            0% { transform: scale(1); }
            50% { transform: scale(1.01); }
            100% { transform: scale(1); }
        }

        @keyframes shake-red {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .top-bar {
                flex-direction: column;
                gap: 0.5rem;
                padding: 0.5rem;
            }
            .top-bar .date-display {
                order: 2; /* Move date to bottom on mobile */
                font-size: 0.8rem;
            }
            .top-bar .whatsapp-link {
                order: 1; /* Move whatsapp to top on mobile */
                font-size: 0.8rem;
            }
            .quiz-title {
                font-size: 1.5rem;
            }
            .banner-logo {
                max-width: 150px;
            }
            .card {
                margin: 0.75rem auto;
                padding: 1rem;
            }
            .button-gradient {
                padding: 0.6rem 1.2rem;
                font-size: 0.9rem;
            }
            .option-button {
                padding: 0.6rem 0.8rem;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>

    <script>
        // Disable right-click, specific keyboard shortcuts (Ctrl+U, Ctrl+Shift+I, Ctrl+Shift+J, F12), copy, and paste
        document.addEventListener('contextmenu', event => event.preventDefault());
        document.addEventListener('keydown', e => {
            if (e.ctrlKey && (e.key === 'u' || e.key === 'U' || e.key === 'I' || e.key === 'i' || e.key === 'J' || e.key === 'j')) {
                e.preventDefault();
            }
            if (e.key === 'F12') {
                e.preventDefault();
            }
        });
        document.addEventListener('copy', event => event.preventDefault());
        document.addEventListener('paste', event => event.preventDefault());
    </script>

    <div class="top-bar">
        <a href="https://chat.whatsapp.com/H3uhXoDodPmAOaVvi3PcZq" target="_blank" class="whatsapp-link">
            <i class="fab fa-whatsapp"></i> Join WhatsApp Community
        </a>
        <div class="date-display" id="liveDate"></div>
    </div>

    <div class="header-section">
        <h1 class="quiz-title" id="quizTitle"></h1>
        <div class="progress-bar-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        <img src="https://i.ibb.co/LXdkJVy8/20250524-0050-Empowering-Educators-remix-01jw0makvqewdvqns1te3jvpgs.png" alt="Banner Logo" class="banner-logo mx-auto">
        <div class="credits">
            KP Teacher Corps | PREPARED BY: SYED ASGHAR ALI SHAH | Contact: 03265762698
            <br>
            Updated on: <span id="updatedDate"></span>
        </div>
    </div>

    <main class="flex-grow flex items-center justify-center p-4">
        <!-- All page sections are initially hidden to prevent flicker -->
        <div id="loginPage" class="card hidden">
            <h2 class="text-xl font-bold mb-4 text-center">Login</h2>
            <div class="mb-4">
                <label for="loginId" class="block text-sm font-medium text-gray-700 mb-1">ID:</label>
                <input type="text" id="loginId" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500" value="">
            </div>
            <div class="mb-6">
                <label for="loginPassword" class="block text-sm font-medium text-gray-700 mb-1">Password:</label>
                <input type="password" id="loginPassword" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500" value="">
            </div>
            <p id="loginError" class="text-red-500 text-sm mb-4 hidden">Invalid ID or Password</p>
            <button id="loginBtn" class="button-gradient w-full">Login</button>
        </div>

        <div id="candidateNamePage" class="card hidden">
            <h2 class="text-xl font-bold mb-4 text-center">Candidate Information</h2>
            <div class="mb-6">
                <label for="candidateName" class="block text-sm font-medium text-gray-700 mb-1">Enter Full Name:</label>
                <input type="text" id="candidateName" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500" placeholder="Your Full Name">
            </div>
            <p id="nameError" class="text-red-500 text-sm mb-4 hidden">Please enter your full name.</p>
            <button id="startQuizBtn" class="button-gradient w-full">Start Quiz</button>
        </div>

        <div id="quizPage" class="card hidden">
            <div class="timer-display" id="timerDisplay"></div>
            <div class="question-progress" id="questionProgress"></div>
            <h2 class="text-lg font-semibold mb-4" id="questionText"></h2>
            <div id="optionsContainer" class="flex flex-col gap-3 mb-6">
            </div>
            <div class="flex justify-between">
                <button id="prevBtn" class="button-gradient px-6 py-2">Previous</button>
                <button id="nextBtn" class="button-gradient px-6 py-2">Next</button>
                <button id="submitQuizBtn" class="button-gradient px-6 py-2 hidden">Submit Quiz</button>
            </div>
            <div id="explanationDiv" class="explanation"></div>
        </div>

        <div id="resultsPage" class="card hidden">
            <h2 class="text-xl font-bold mb-4 text-center">Quiz Results</h2>
            <p class="mb-2"><strong>Candidate Name:</strong> <span id="resultCandidateName"></span></p>
            <p class="mb-2"><strong>Date of Quiz:</strong> <span id="resultDate"></span></p>
            <p class="mb-2"><strong>Score:</strong> <span id="resultScore"></span> / <span id="maxScore"></span></p>
            <p class="mb-2"><strong>Correct Answers:</strong> <span id="resultCorrect"></span></p>
            <p class="mb-2"><strong>Incorrect Answers:</strong> <span id="resultIncorrect"></span></p>
            <p class="mb-4"><strong>Time Taken:</strong> <span id="resultTimeTaken"></span></p>
            <button id="restartQuizBtn" class="button-gradient w-full">Restart Quiz</button>
        </div>
    </main>

    <script>
        // Set the current date for display and logic
        const CURRENT_DATE_STR = "June 26, 2025";
        const CURRENT_DATE = new Date(CURRENT_DATE_STR);

        // Update header dates
        document.getElementById('liveDate').textContent = CURRENT_DATE_STR;
        document.getElementById('updatedDate').textContent = CURRENT_DATE_STR;
        document.getElementById('quizTitle').textContent = `Day 8 Quiz - EDUCATION DEPARTMENT SCREENING TEST PREPARATION – ${CURRENT_DATE_STR}`;

        // Quiz Data Structure
        const originalQuizQuestions = []; // Stores the initial, unshuffled questions
        let quizQuestions = []; // This array will be shuffled and used for the current quiz
        let currentQuestionIndex = 0;
        // Stores { questionIndex: int (original index), selectedOptionIndex: int (index in shuffled options), isCorrect: bool, originalCorrectOptionIndex: int }
        let userAnswers = []; 
        let quizStartTime;
        let timerInterval;
        const QUIZ_DURATION_MINUTES = 40; // Default quiz duration
        let specialQuestionOriginalIndex = -1; // To store the original index of the special question

        // --- Helper Functions ---

        /**
         * Shuffles an array in place using Fisher-Yates (Knuth) shuffle.
         * @param {Array} array - The array to shuffle.
         */
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        /**
         * Converts seconds to a human-readable time string (e.g., "35 minutes 10 seconds").
         * @param {number} totalSeconds - The total number of seconds.
         * @returns {string} Formatted time string.
         */
        function formatTime(totalSeconds) {
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            return `${minutes} minutes ${seconds} seconds`;
        }

        /**
         * Updates the progress bar and question progress text.
         */
        function updateProgressBar() {
            const progress = ((currentQuestionIndex + 1) / quizQuestions.length) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
            document.getElementById('questionProgress').textContent = `Question ${currentQuestionIndex + 1}/${quizQuestions.length} – ${Math.round(progress)}% Complete`;
        }

        /**
         * Displays a specific page and hides others.
         * @param {string} pageId - The ID of the page to display.
         */
        function showPage(pageId) {
            document.getElementById('loginPage').classList.add('hidden');
            document.getElementById('candidateNamePage').classList.add('hidden');
            document.getElementById('quizPage').classList.add('hidden');
            document.getElementById('resultsPage').classList.add('hidden');
            document.getElementById(pageId).classList.remove('hidden');
        }

        /**
         * Starts the quiz timer.
         */
        function startTimer() {
            quizStartTime = Date.now();
            let timeLeft = QUIZ_DURATION_MINUTES * 60; // Convert minutes to seconds

            function updateTimerDisplay() {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                document.getElementById('timerDisplay').textContent = `Time Left: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    submitQuiz(true); // Auto-submit on timer expiry
                } else {
                    timeLeft--;
                }
            }

            updateTimerDisplay(); // Initial display
            timerInterval = setInterval(updateTimerDisplay, 1000);
        }

        /**
         * Renders the current question and its options.
         */
        function renderQuestion() {
            const question = quizQuestions[currentQuestionIndex];
            document.getElementById('questionText').innerHTML = question.question;
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = ''; // Clear previous options

            // Remove special-question class from previous question if any
            const quizCard = document.getElementById('quizPage');
            quizCard.classList.remove('special-question');

            // Add special-question class if it's today's special question and date matches
            const today = new Date().toDateString();
            if (question.special && CURRENT_DATE.toDateString() === today) {
                quizCard.classList.add('special-question');
            }
            
            // Create a shuffled copy of the options for the current question
            // We need to store the original index mapping before shuffling
            const shuffledOptionsWithOriginalIndex = question.options.map((option, index) => ({
                optionText: option,
                originalIndex: index
            }));
            shuffleArray(shuffledOptionsWithOriginalIndex);

            // Store the shuffled options and their original correct index for this question
            // This allows us to track the correct option even after shuffling
            quizQuestions[currentQuestionIndex].shuffledOptions = shuffledOptionsWithOriginalIndex;
            quizQuestions[currentQuestionIndex].shuffledCorrectOptionIndex = shuffledOptionsWithOriginalIndex.findIndex(
                opt => opt.originalIndex === question.correctOptionIndex
            );

            shuffledOptionsWithOriginalIndex.forEach((optionObj, index) => {
                const button = document.createElement('button');
                button.classList.add('option-button', 'w-full');
                button.innerHTML = optionObj.optionText; // Use innerHTML to render LaTeX
                button.dataset.shuffledOptionIndex = index; // Store the shuffled index
                button.onclick = () => selectOption(index);

                // Apply selected state if already answered
                const userAnswer = userAnswers[currentQuestionIndex];
                if (userAnswer && userAnswer.selectedOptionIndex === index) {
                    button.classList.add('selected');
                    if (userAnswer.isCorrect) {
                        button.classList.add('correct');
                    } else {
                        button.classList.add('incorrect');
                    }
                    // Disable all options if already answered
                    Array.from(optionsContainer.children).forEach(optBtn => optBtn.disabled = true);
                    document.getElementById('explanationDiv').style.display = 'block';
                }
                optionsContainer.appendChild(button);
            });

            // Render math equations using MathJax if available
            if (typeof MathJax !== 'undefined') {
                MathJax.typesetPromise([document.getElementById('questionText'), optionsContainer]);
            }


            // Show/hide explanation
            const explanationDiv = document.getElementById('explanationDiv');
            explanationDiv.innerHTML = `<p class="font-bold">Explanation:</p><p>${question.explanation}</p>`;
            if (typeof MathJax !== 'undefined') {
                MathJax.typesetPromise([explanationDiv]);
            }
            if (userAnswers[currentQuestionIndex] && userAnswers[currentQuestionIndex].selectedOptionIndex !== undefined) {
                explanationDiv.style.display = 'block';
            } else {
                explanationDiv.style.display = 'none';
            }

            // Update navigation buttons visibility
            document.getElementById('prevBtn').classList.toggle('hidden', currentQuestionIndex === 0);
            document.getElementById('nextBtn').classList.toggle('hidden', currentQuestionIndex === quizQuestions.length - 1);
            document.getElementById('submitQuizBtn').classList.toggle('hidden', currentQuestionIndex !== quizQuestions.length - 1);

            updateProgressBar();
        }

        /**
         * Handles option selection by the user.
         * @param {number} selectedOptionIndex - The index of the selected option from the SHUFFLED options.
         */
        function selectOption(selectedOptionIndex) {
            const question = quizQuestions[currentQuestionIndex];
            const isCorrect = (selectedOptionIndex === question.shuffledCorrectOptionIndex);

            // Store user's answer
            userAnswers[currentQuestionIndex] = {
                questionIndex: currentQuestionIndex,
                selectedOptionIndex: selectedOptionIndex, // This is the index in the SHUFFLED options
                isCorrect: isCorrect,
                originalCorrectOptionIndex: question.correctOptionIndex // Store original correct index for reference if needed
            };

            // Apply visual feedback
            const optionsContainer = document.getElementById('optionsContainer');
            Array.from(optionsContainer.children).forEach((button, index) => {
                button.disabled = true; // Disable all options after selection
                button.classList.remove('selected', 'correct', 'incorrect'); // Clear previous states

                if (index === selectedOptionIndex) {
                    button.classList.add('selected');
                    if (isCorrect) {
                        button.classList.add('correct');
                    } else {
                        button.classList.add('incorrect');
                    }
                } else if (index === question.shuffledCorrectOptionIndex) {
                    // Highlight the correct answer even if not selected by the user
                    button.classList.add('correct');
                }
            });

            // Show explanation
            document.getElementById('explanationDiv').style.display = 'block';
             // Render math equations in explanation
            if (typeof MathJax !== 'undefined') {
                MathJax.typesetPromise([document.getElementById('explanationDiv')]);
            }
        }

        /**
         * Navigates to the next question.
         */
        function nextQuestion() {
            if (currentQuestionIndex < quizQuestions.length - 1) {
                currentQuestionIndex++;
                renderQuestion();
            }
        }

        /**
         * Navigates to the previous question.
         */
        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                renderQuestion();
            }
        }

        /**
         * Submits the quiz, calculates results, and displays them.
         * @param {boolean} isAutoSubmit - True if submitted by timer, false otherwise.
         */
        function submitQuiz(isAutoSubmit = false) {
            clearInterval(timerInterval); // Stop the timer

            const endTime = Date.now();
            const timeTakenSeconds = Math.round((endTime - quizStartTime) / 1000);

            let correctCount = 0;
            let incorrectCount = 0;
            let totalAttempted = 0;

            userAnswers.forEach(answer => {
                if (answer && answer.selectedOptionIndex !== undefined) {
                    totalAttempted++;
                    if (answer.isCorrect) {
                        correctCount++;
                    } else {
                        incorrectCount++;
                    }
                }
            });

            const maxPossibleScore = quizQuestions.length * 2; // 2 points per question
            const score = (correctCount * 2) - incorrectCount; // Score calculation: 2 for correct, -1 for incorrect

            const candidateName = document.getElementById('candidateName').value;

            document.getElementById('resultCandidateName').textContent = candidateName;
            document.getElementById('resultDate').textContent = CURRENT_DATE_STR;
            document.getElementById('resultScore').textContent = score;
            document.getElementById('maxScore').textContent = maxPossibleScore;
            document.getElementById('resultCorrect').textContent = `${correctCount} / ${totalAttempted}`;
            document.getElementById('resultIncorrect').textContent = `${incorrectCount} / ${totalAttempted}`;
            document.getElementById('resultTimeTaken').textContent = formatTime(timeTakenSeconds);

            showPage('resultsPage');

            // Silent Formspree submission
            const formData = new FormData();
            formData.append('Candidate Name', candidateName);
            formData.append('Date of Quiz', CURRENT_DATE_STR);
            formData.append('Score', score);
            formData.append('Correct Answers', correctCount);
            formData.append('Incorrect Answers', incorrectCount);
            formData.append('Time Taken', formatTime(timeTakenSeconds));
            formData.append('Quiz ID', "day8"); // Specific ID for Day 8 quiz

            fetch('https://formspree.io/f/xwpojgab', {
                method: 'POST',
                body: formData,
                headers: {
                    'Accept': 'application/json'
                }
            }).then(response => {
                if (response.ok) {
                    console.log('Quiz results submitted successfully!');
                } else {
                    console.error('Formspree submission failed.');
                }
            }).catch(error => {
                console.error('Error during Formspree submission:', error);
            });
        }

        // --- Event Listeners ---

        document.getElementById('loginBtn').addEventListener('click', () => {
            const id = document.getElementById('loginId').value;
            const password = document.getElementById('loginPassword').value;
            const loginError = document.getElementById('loginError');

            // Specific credentials for Day 8
            if (id === 'day8' && password === '8888') {
                loginError.classList.add('hidden');
                showPage('candidateNamePage');
            } else {
                loginError.classList.remove('hidden');
            }
        });

        document.getElementById('startQuizBtn').addEventListener('click', () => {
            const candidateNameInput = document.getElementById('candidateName');
            const candidateName = candidateNameInput.value.trim();
            const nameError = document.getElementById('nameError');

            if (candidateName) {
                nameError.classList.add('hidden');
                // Initialize userAnswers array for the new quiz attempt
                userAnswers = new Array(quizQuestions.length).fill(null);
                currentQuestionIndex = 0;
                startTimer();
                renderQuestion();
                showPage('quizPage');
            } else {
                nameError.classList.remove('hidden');
            }
        });

        document.getElementById('nextBtn').addEventListener('click', nextQuestion);
        document.getElementById('prevBtn').addEventListener('click', prevQuestion);
        document.getElementById('submitQuizBtn').addEventListener('click', () => submitQuiz(false));
        document.getElementById('restartQuizBtn').addEventListener('click', () => {
            // Reset quiz state
            currentQuestionIndex = 0;
            userAnswers = [];
            clearInterval(timerInterval); // Clear any lingering timer
            // Re-initialize and re-shuffle questions for a new attempt
            initializeQuiz(); 
            // Clear login fields and go back to login page
            document.getElementById('loginId').value = '';
            document.getElementById('loginPassword').value = '';
            document.getElementById('candidateName').value = '';
            showPage('loginPage');
        });

        // --- Quiz Initialization ---
        function initializeQuiz() {
            // Populate originalQuizQuestions (only once) if not already populated
            if (originalQuizQuestions.length === 0) {
                // Pedagogy (15 MCQs from Pages 11-20, 29-32, ensuring no duplicates with Day 5, 6, 7)
                const pedagogyMCQs = [
                    { question: "What is 'Behaviorism' in educational psychology?", options: ["A theory that focuses on mental processes.", "A theory of learning that states all behaviors are learned through interaction with the environment through a process called conditioning.", "A theory about social development.", "A theory that emphasizes innate ideas."], correctOptionIndex: 1, explanation: "Behaviorism, pioneered by Pavlov, Watson, and Skinner, focuses on observable behaviors (Page 29)." },
                    { question: "Who is known for 'Classical Conditioning'?", options: ["Jean Piaget", "B.F. Skinner", "Ivan Pavlov", "Albert Bandura"], correctOptionIndex: 2, explanation: "Ivan Pavlov's experiments with dogs are a classic example of classical conditioning (Page 29)." },
                    { question: "Who is known for 'Operant Conditioning'?", options: ["Ivan Pavlov", "B.F. Skinner", "Sigmund Freud", "Lev Vygotsky"], correctOptionIndex: 1, explanation: "B.F. Skinner developed operant conditioning, where learning occurs through rewards and punishments (Page 29)." },
                    { question: "What is 'positive reinforcement'?", options: ["Adding something undesirable to decrease a behavior.", "Adding something desirable to increase a behavior.", "Removing something desirable to increase a behavior.", "Removing something undesirable to decrease a behavior."], correctOptionIndex: 1, explanation: "Positive reinforcement strengthens a behavior by providing a positive consequence (Page 30)." },
                    { question: "What is 'negative reinforcement'?", options: ["Adding something desirable.", "Adding something undesirable to decrease a behavior.", "Removing something undesirable to increase a behavior.", "Removing something desirable to decrease a behavior."], correctOptionIndex: 2, explanation: "Negative reinforcement strengthens a behavior by removing an unpleasant stimulus (Page 30)." },
                    { question: "What is 'punishment'?", options: ["A process that strengthens a behavior.", "A process that weakens or decreases the likelihood of a behavior occurring again.", "A process that motivates students.", "A process of providing rewards."], correctOptionIndex: 1, explanation: "Punishment aims to reduce the frequency of an undesirable behavior (Page 30)." },
                    { question: "What is 'observational learning' (or social learning theory)?", options: ["Learning by trial and error.", "Learning by observing others and imitating their behavior.", "Learning through direct instruction.", "Learning through intrinsic motivation."], correctOptionIndex: 1, explanation: "Albert Bandura's theory emphasizes the role of modeling and imitation in learning (Page 31)." },
                    { question: "What are the four components of observational learning?", options: ["Attention, Retention, Reproduction, Motivation", "Stimulus, Response, Reinforcement, Punishment", "Id, Ego, Superego, Libido", "Sensorimotor, Preoperational, Concrete Operational, Formal Operational"], correctOptionIndex: 0, explanation: "Bandura identified these four key processes involved in learning from observation (Page 31)." },
                    { question: "What is the purpose of 'assessment' in education?", options: ["To punish students.", "To measure student learning, identify areas for improvement, and evaluate the effectiveness of teaching.", "To compare students to each other.", "To rank schools based on performance."], correctOptionIndex: 1, explanation: "Assessment is integral to the teaching and learning process (Page 32)." },
                    { question: "What is 'reliability' in assessment?", options: ["The extent to which a test measures what it is intended to measure.", "The consistency of a measure, indicating that the same results would be obtained under the same conditions.", "The ease with which a test can be administered.", "The relevance of a test to the curriculum."], correctOptionIndex: 1, explanation: "Reliability ensures that test results are consistent and repeatable (Page 32)." },
                    { question: "What is 'validity' in assessment?", options: ["The consistency of a measure.", "The extent to which a test measures what it is intended to measure.", "The ease of administration.", "The cost-effectiveness of a test."], correctOptionIndex: 1, explanation: "Validity ensures that a test accurately measures the desired construct (Page 32)." },
                    { question: "Which term refers to the process of acquiring knowledge and skills through experience, study, or by being taught?", options: ["Education", "Teaching", "Learning", "Development"], correctOptionIndex: 2, explanation: "Learning is a fundamental process in education (Page 9)." },
                    { question: "What type of education is characterized by being structured, hierarchical, planned, and deliberate, usually taking place in a school setting?", options: ["Informal education", "Non-formal education", "Formal education", "Self-education"], correctOptionIndex: 2, explanation: "Formal education includes schools, colleges, and universities with set curricula (Page 9)." },
                    { question: "Which type of education is spontaneous, lifelong, and occurs through daily experiences and interactions, without a fixed syllabus or timetable?", options: ["Formal education", "Non-formal education", "Informal education", "Structured learning"], correctOptionIndex: 2, explanation: "Informal education is natural and continuous, like learning a mother tongue (Page 10)." },
                    { question: "Which type of education is organized outside the formal system, often catering to specific needs or groups, with flexible curriculum and methods?", options: ["Formal education", "Informal education", "Non-formal education", "Traditional education"], correctOptionIndex: 2, explanation: "Non-formal education includes workshops, community education, or vocational training (Page 11)." }
                ];
                originalQuizQuestions.push(...pedagogyMCQs);

                // General Science (20 MCQs from Pages 141-170, 207-224, ensuring no duplicates with Day 5, 6, 7)
                const generalScienceMCQs = [
                    { question: "What is the function of the 'nervous system'?", options: ["Digestion", "Breathing", "Control and communication", "Pumping blood"], correctOptionIndex: 2, explanation: "The nervous system coordinates all body functions (Page 207)." },
                    { question: "What are the basic units of the nervous system?", options: ["Neurons", "Muscles", "Bones", "Glands"], correctOptionIndex: 0, explanation: "Neurons transmit electrical and chemical signals (Page 208)." },
                    { question: "Which part of the neuron receives signals from other neurons?", options: ["Axon", "Myelin sheath", "Dendrite", "Cell body"], correctOptionIndex: 2, explanation: "Dendrites are tree-like branches that receive incoming signals (Page 209)." },
                    { question: "Which part of the neuron transmits signals to other neurons, muscles, or glands?", options: ["Dendrite", "Cell body", "Axon", "Synapse"], correctOptionIndex: 2, explanation: "The axon carries nerve impulses away from the cell body (Page 210)." },
                    { question: "What is the small gap between two neurons where signals are transmitted?", options: ["Axon terminal", "Dendrite", "Synapse", "Myelin sheath"], correctOptionIndex: 2, explanation: "Neurotransmitters are released into the synapse to transmit signals (Page 211)." },
                    { question: "What is the central nervous system (CNS) composed of?", options: ["Nerves and ganglia", "Brain and spinal cord", "Muscles and bones", "Glands and hormones"], correctOptionIndex: 1, explanation: "The CNS is the main control center of the body (Page 212)." },
                    { question: "What is the peripheral nervous system (PNS) composed of?", options: ["Brain and spinal cord", "Nerves extending from the brain and spinal cord to the rest of the body", "Only sensory neurons", "Only motor neurons"], correctOptionIndex: 1, explanation: "The PNS connects the CNS to the limbs and organs (Page 213)." },
                    { question: "Which part of the brain controls balance and coordination?", options: ["Cerebrum", "Brainstem", "Cerebellum", "Thalamus"], correctOptionIndex: 2, explanation: "The cerebellum is crucial for fine motor control (Page 214)." },
                    { question: "Which part of the brain controls involuntary actions like breathing and heart rate?", options: ["Cerebrum", "Cerebellum", "Brainstem", "Hypothalamus"], correctOptionIndex: 2, explanation: "The brainstem connects the cerebrum and cerebellum to the spinal cord (Page 215)." },
                    { question: "What is 'reflex action'?", options: ["A conscious decision to move a muscle.", "An involuntary and almost instantaneous movement in response to a stimulus.", "A learned behavior.", "A movement controlled by the cerebrum."], correctOptionIndex: 1, explanation: "Reflex actions are protective mechanisms that bypass the brain (Page 216)." },
                    { question: "What is the function of the 'endocrine system'?", options: ["Digesting food", "Producing and secreting hormones to regulate body processes", "Pumping blood", "Fighting infections"], correctOptionIndex: 1, explanation: "The endocrine system works alongside the nervous system to maintain homeostasis (Page 217)." },
                    { question: "What are 'hormones'?", options: ["Electrical signals.", "Chemical messengers produced by glands that travel through the bloodstream to target organs.", "Nutrients absorbed from food.", "Waste products."], correctOptionIndex: 1, explanation: "Hormones regulate various physiological processes (Page 218)." },
                    { question: "Which gland is often called the 'master gland' because it controls many other endocrine glands?", options: ["Thyroid gland", "Adrenal gland", "Pituitary gland", "Pancreas"], correctOptionIndex: 2, explanation: "The pituitary gland is located at the base of the brain (Page 219)." },
                    { question: "Which hormone is produced by the pancreas and regulates blood sugar levels?", options: ["Adrenaline", "Thyroxine", "Insulin", "Estrogen"], correctOptionIndex: 2, explanation: "Insulin lowers blood glucose, while glucagon raises it (Page 220)." },
                    { question: "What is the function of the 'thyroid gland'?", options: ["Regulating blood sugar.", "Controlling metabolism and energy levels.", "Producing adrenaline.", "Regulating calcium levels."], correctOptionIndex: 1, explanation: "The thyroid gland produces hormones like thyroxine (Page 221)." },
                    { question: "Which nutrient provides the main source of energy for the body?", options: ["Vitamins", "Minerals", "Carbohydrates", "Proteins"], correctOptionIndex: 2, explanation: "Carbohydrates are broken down into glucose for energy (Page 151)." },
                    { question: "Which nutrient is essential for growth and repair of body tissues?", options: ["Fats", "Vitamins", "Carbohydrates", "Proteins"], correctOptionIndex: 3, explanation: "Proteins are building blocks for muscles, skin, and organs (Page 152)." },
                    { question: "Which vitamin is crucial for vision and immune function?", options: ["Vitamin C", "Vitamin D", "Vitamin A", "Vitamin K"], correctOptionIndex: 2, explanation: "Vitamin A is vital for healthy eyesight (Page 153)." },
                    { question: "Which mineral is necessary for strong bones and teeth?", options: ["Iron", "Potassium", "Calcium", "Sodium"], correctOptionIndex: 2, explanation: "Calcium is a primary component of bone structure (Page 154)." },
                    { question: "What is the smallest unit of matter that retains an element's chemical properties?", options: ["Molecule", "Compound", "Atom", "Cell"], correctOptionIndex: 2, explanation: "Atoms are the fundamental particles of elements (Page 160)." }
                ];
                originalQuizQuestions.push(...generalScienceMCQs);

                // Social Studies (15 MCQs from Pages 510-524, 561-578, ensuring no duplicates with Day 5, 6, 7)
                const socialStudiesMCQs = [
                    { question: "What is 'culture'?", options: ["A type of government.", "The shared beliefs, values, customs, behaviors, and artifacts that characterize a group or society.", "A person's individual personality.", "Economic system of a country."], correctOptionIndex: 1, explanation: "Culture shapes how people live and interact (Page 561)." },
                    { question: "Which of the following is an example of a 'material culture'?", options: ["Beliefs", "Values", "Language", "Tools and art"], correctOptionIndex: 3, explanation: "Material culture refers to the physical objects created and used by a society (Page 562)." },
                    { question: "Which of the following is an example of a 'non-material culture'?", options: ["Buildings", "Clothing", "Customs and traditions", "Technology"], correctOptionIndex: 2, explanation: "Non-material culture includes abstract human creations (Page 563)." },
                    { question: "What is 'society'?", options: ["A single person living alone.", "A group of people who share a common culture, occupy a particular territorial area, and feel themselves to constitute a unified and distinct entity.", "A formal organization.", "A government body."], correctOptionIndex: 1, explanation: "Society is a structured community of individuals (Page 564)." },
                    { question: "What are 'norms' in society?", options: ["Laws written by the government.", "Shared rules of conduct that tell people how to act in specific situations.", "Individual opinions.", "Religious beliefs only."], correctOptionIndex: 1, explanation: "Norms guide behavior and maintain social order (Page 565)." },
                    { question: "What are 'folkways'?", options: ["Strict moral codes.", "Everyday customs and conventions of a society, often not strictly enforced.", "Formal laws.", "Rituals with deep moral significance."], correctOptionIndex: 1, explanation: "Folkways are informal rules for polite interaction (Page 566)." },
                    { question: "What are 'mores'?", options: ["Informal customs.", "Norms that are widely observed and have great moral significance.", "Fashion trends.", "Technical instructions."], correctOptionIndex: 1, explanation: "Mores are essential to a society's well-being and often carry severe penalties for violation (Page 567)." },
                    { question: "What are 'laws' in society?", options: ["Unwritten rules.", "Formalized norms enforced by political authority.", "Personal preferences.", "Religious guidelines."], correctOptionIndex: 1, explanation: "Laws are codified rules with official sanctions (Page 568)." },
                    { question: "What is 'socialization'?", options: ["Ignoring social interaction.", "The lifelong process through which individuals acquire the knowledge, skills, and values of their culture and learn to function as members of society.", "Genetic inheritance.", "Independent learning."], correctOptionIndex: 1, explanation: "Socialization shapes individuals into social beings (Page 569)." },
                    { question: "Which of the following is a primary agent of socialization?", options: ["Mass media", "Peer groups", "Family", "Government"], correctOptionIndex: 2, explanation: "The family is the earliest and most influential agent of socialization (Page 570)." },
                    { question: "What is a 'map'?", options: ["A drawing of a house.", "A symbolic representation of selected characteristics of a place, usually drawn on a flat surface.", "A photograph of a landscape.", "A globe."], correctOptionIndex: 1, explanation: "Maps are essential tools in geography (Page 510)." },
                    { question: "What is 'cartography'?", options: ["The study of rivers.", "The art and science of making maps.", "The study of rocks.", "The study of climate."], correctOptionIndex: 1, explanation: "Cartography involves designing, compiling, and producing maps (Page 511)." },
                    { question: "What does the 'scale' of a map represent?", options: ["The size of the paper.", "The relationship between a distance on the map and the corresponding distance on the ground.", "The colors used on the map.", "The age of the map."], correctOptionIndex: 1, explanation: "Scale is crucial for understanding real-world distances from a map (Page 512)." },
                    { question: "Which type of map shows detailed natural features like mountains, rivers, and elevation?", options: ["Political map", "Economic map", "Topographic map", "Road map"], correctOptionIndex: 2, explanation: "Topographic maps use contour lines to show elevation (Page 513)." },
                    { question: "Which cardinal direction is opposite to North?", options: ["East", "West", "South", "North-East"], correctOptionIndex: 2, explanation: "Cardinal directions are fundamental for navigation (Page 514)." }
                ];
                originalQuizQuestions.push(...socialStudiesMCQs);

                // English (15 MCQs from Pages 817-830, 847-854, ensuring no duplicates)
                const englishMCQs = [
                    { question: "Which type of sentence makes a statement and ends with a period?", options: ["Interrogative", "Imperative", "Exclamatory", "Declarative"], correctOptionIndex: 3, explanation: "Declarative sentences are the most common type and state facts or opinions (Page 847)." },
                    { question: "Which type of sentence asks a question and ends with a question mark?", options: ["Declarative", "Imperative", "Interrogative", "Exclamatory"], correctOptionIndex: 2, explanation: "Interrogative sentences seek information (Page 847)." },
                    { question: "Which type of sentence gives a command or makes a request, often with an implied subject 'you'?", options: ["Declarative", "Interrogative", "Imperative", "Exclamatory"], correctOptionIndex: 2, explanation: "Imperative sentences tell someone to do something (Page 848)." },
                    { question: "Which type of sentence expresses strong emotion and ends with an exclamation mark?", options: ["Declarative", "Interrogative", "Imperative", "Exclamatory"], correctOptionIndex: 3, explanation: "Exclamatory sentences convey excitement, surprise, or other strong feelings (Page 848)." },
                    { question: "A sentence containing one independent clause is called a __________ sentence.", options: ["Compound", "Complex", "Simple", "Compound-Complex"], correctOptionIndex: 2, explanation: "Simple sentences have a single subject-verb pair and express one complete thought (Page 849)." },
                    { question: "Identify the type of sentence: 'The cat slept soundly.'", options: ["Compound", "Simple", "Complex", "Exclamatory"], correctOptionIndex: 1, explanation: "This sentence has one subject ('cat') and one verb ('slept'), forming a single independent clause (Page 849)." },
                    { question: "A sentence containing two or more independent clauses joined by a coordinating conjunction (for, and, nor, but, or, yet, so) is called a __________ sentence.", options: ["Simple", "Complex", "Compound", "Compound-Complex"], correctOptionIndex: 2, explanation: "Compound sentences combine two or more complete thoughts (Page 850)." },
                    { question: "Identify the type of sentence: 'I went to the store, and I bought some milk.'", options: ["Simple", "Complex", "Compound", "Declarative"], correctOptionIndex: 2, explanation: "This sentence has two independent clauses joined by 'and' (Page 850)." },
                    { question: "A sentence containing one independent clause and at least one dependent clause is called a __________ sentence.", options: ["Simple", "Compound", "Complex", "Compound-Complex"], correctOptionIndex: 2, explanation: "Complex sentences show a relationship between a main idea and a subordinate idea (Page 851)." },
                    { question: "Identify the type of sentence: 'Although it was raining, we still went for a walk.'", options: ["Simple", "Compound", "Complex", "Imperative"], correctOptionIndex: 2, explanation: "'Although it was raining' is a dependent clause, and 'we still went for a walk' is an independent clause (Page 851)." },
                    { question: "What is the definition of a 'sentence'?", options: ["A group of words.", "A group of words that expresses a complete thought and contains a subject and a predicate.", "A single word.", "A phrase."], correctOptionIndex: 1, explanation: "A sentence is the fundamental unit of communication (Page 817)." },
                    { question: "Which part of a sentence tells what the sentence is about?", options: ["Predicate", "Verb", "Object", "Subject"], correctOptionIndex: 3, explanation: "The subject performs or is the focus of the action (Page 817)." },
                    { question: "Which part of a sentence tells something about the subject, including the verb?", options: ["Subject", "Noun", "Predicate", "Adverb"], correctOptionIndex: 2, explanation: "The predicate provides information about the subject's action or state (Page 818)." },
                    { question: "What is the function of an 'article' (a, an, the)?", options: ["To describe a verb.", "To modify an adjective.", "To define or specify a noun.", "To connect two clauses."], correctOptionIndex: 2, explanation: "Articles are determiners that introduce nouns (Page 820)." },
                    { question: "Which article is used before a singular countable noun that starts with a consonant sound?", options: ["An", "The", "A", "None"], correctOptionIndex: 2, explanation: "'A' is used for general, non-specific nouns starting with a consonant sound (Page 820)." }
                ];
                originalQuizQuestions.push(...englishMCQs);

                // Mathematics (15 MCQs from Pages 947-981, 996-1002, ensuring no duplicates)
                const mathematicsMCQs = [
                    { question: "Solve for $x$: $x + 7 = 15$", options: ["7", "8", "9", "10"], correctOptionIndex: 1, explanation: "Subtract 7 from both sides: $x = 15 - 7 = 8$ (Page 996)." },
                    { question: "Solve for $y$: $3y = 21$", options: ["6", "7", "8", "9"], correctOptionIndex: 1, explanation: "Divide both sides by 3: $y = 21 / 3 = 7$ (Page 997)." },
                    { question: "Solve for $a$: $a / 5 = 4$", options: ["10", "15", "20", "25"], correctOptionIndex: 2, explanation: "Multiply both sides by 5: $a = 4 \\times 5 = 20$ (Page 998)." },
                    { question: "Simplify the expression: $2x + 3y + 5x - y$", options: ["$7x + 2y$", "$7x + 4y$", "$3x + 2y$", "$7x - 2y$"], correctOptionIndex: 0, explanation: "Combine like terms: $(2x + 5x) + (3y - y) = 7x + 2y$ (Page 999)." },
                    { question: "Evaluate $3^4$", options: ["9", "12", "64", "81"], correctOptionIndex: 3, explanation: "$3^4 = 3 \\times 3 \\times 3 \\times 3 = 81$ (Page 1000)." },
                    { question: "If $a = 3$ and $b = 5$, find the value of $2a + b$.", options: ["8", "10", "11", "13"], correctOptionIndex: 2, explanation: "Substitute the values: $2(3) + 5 = 6 + 5 = 11$ (Page 1001)." },
                    { question: "Solve for $x$: $2x - 5 = 11$", options: ["6", "7", "8", "9"], correctOptionIndex: 2, explanation: "Add 5 to both sides: $2x = 16$. Divide by 2: $x = 8$ (Page 997)." },
                    { question: "Which of the following is an inequality?", options: ["$x = 5$", "$2x + 3 = 7$", "$y < 10$", "$a - 4 = 1$"], correctOptionIndex: 2, explanation: "An inequality uses symbols like $<, >, \\le, \\ge$ (Page 1002)." },
                    { question: "If a car travels at a speed of 60 km/h for 3 hours, what is the distance covered?", options: ["20 km", "63 km", "180 km", "200 km"], correctOptionIndex: 2, explanation: "Distance = Speed $\\times$ Time = $60 \\times 3 = 180$ km (Page 1002)." },
                    { question: "What is the perimeter of a rectangle with length 12 cm and width 8 cm?", options: ["20 cm", "40 cm", "96 cm", "100 cm"], correctOptionIndex: 1, explanation: "Perimeter = $2 \\times (length + width) = 2 \\times (12 + 8) = 2 \\times 20 = 40$ cm (Page 1002)." },
                    { question: "What is the place value of the digit '5' in the number 345,678?", options: ["Hundreds", "Thousands", "Ten Thousands", "Lakhs"], correctOptionIndex: 1, explanation: "The digit 5 is in the thousands place (Page 947)." },
                    { question: "What is the sum of 1234 and 5678?", options: ["6802", "6912", "7002", "7102"], correctOptionIndex: 1, explanation: "Addition of whole numbers (Page 948)." },
                    { question: "What is the difference between 9876 and 5432?", options: ["4444", "4454", "4544", "4644"], correctOptionIndex: 0, explanation: "Subtraction of whole numbers (Page 949)." },
                    { question: "What is the product of 25 and 30?", options: ["500", "750", "1000", "1250"], correctOptionIndex: 1, explanation: "Multiplication of whole numbers (Page 950)." },
                    { question: "What is the result of $450 \\div 9$?", options: ["40", "50", "60", "70"], correctOptionIndex: 1, explanation: "Division of whole numbers (Page 951)." }
                ];
                originalQuizQuestions.push(...mathematicsMCQs);

                // History (10 MCQs from Pages 740-790)
                const historyMCQs = [
                    { question: "Who was the founder of the Mughal Empire in India?", options: ["Akbar", "Humayun", "Babur", "Shah Jahan"], correctOptionIndex: 2, explanation: "Babur established the Mughal Empire in 1526 after the Battle of Panipat (Page 740)." },
                    { question: "Which Mughal emperor built the Taj Mahal?", options: ["Akbar", "Jahangir", "Shah Jahan", "Aurangzeb"], correctOptionIndex: 2, explanation: "The Taj Mahal was built by Shah Jahan in memory of his wife Mumtaz Mahal (Page 741)." },
                    { question: "When did the British East India Company establish its first trading post in India?", options: ["1600", "1608", "1612", "1615"], correctOptionIndex: 2, explanation: "The British East India Company established its first factory in Surat in 1612 (Page 742)." },
                    { question: "What was the 'Sepoy Mutiny' or 'Indian Rebellion of 1857'?", options: ["A peaceful protest.", "A major uprising against British rule in India.", "A trade dispute.", "A religious festival."], correctOptionIndex: 1, explanation: "The rebellion was a significant turning point in Indian history (Page 743)." },
                    { question: "Who was the last Mughal Emperor?", options: ["Akbar II", "Bahadur Shah II", "Shah Alam II", "Aurangzeb"], correctOptionIndex: 1, explanation: "Bahadur Shah II was exiled after the 1857 rebellion (Page 744)." },
                    { question: "When was the Indian National Congress founded?", options: ["1880", "1885", "1890", "1900"], correctOptionIndex: 1, explanation: "The Indian National Congress played a key role in the independence movement (Page 745)." },
                    { question: "Who coined the slogan 'Swaraj is my birthright, and I shall have it!'?", options: ["Mahatma Gandhi", "Jawaharlal Nehru", "Bal Gangadhar Tilak", "Subhas Chandra Bose"], correctOptionIndex: 2, explanation: "This slogan became a powerful call for self-rule (Page 746)." },
                    { question: "When did the Partition of Bengal take place?", options: ["1900", "1905", "1910", "1915"], correctOptionIndex: 1, explanation: "The partition of Bengal in 1905 caused widespread protests and strengthened the nationalist movement (Page 747)." },
                    { question: "Who was the founder of the All-India Muslim League?", options: ["Muhammad Ali Jinnah", "Allama Iqbal", "Nawab Waqar-ul-Mulk", "Syed Ahmed Khan"], correctOptionIndex: 2, explanation: "The Muslim League was founded in 1906 to protect Muslim interests (Page 748)." },
                    { question: "When did Pakistan gain independence?", options: ["August 14, 1947", "August 15, 1947", "August 14, 1948", "August 15, 1948"], correctOptionIndex: 0, explanation: "Pakistan gained independence on August 14, 1947 (Page 749)." }
                ];
                originalQuizQuestions.push(...historyMCQs);

                // Urdu (5 MCQs from Pages 1222-1248)
                const urduMCQs = [
                    { question: "اردو قواعد میں 'فعل ناقص' سے کیا مراد ہے؟", options: ["وہ فعل جو کام کو مکمل ظاہر کرے", "وہ فعل جو کسی کام کے ہونے یا نہ ہونے کو ظاہر کرے لیکن اس کے لیے فاعل اور مفعول کی ضرورت نہ ہو", "وہ فعل جو صرف فاعل کو ظاہر کرے", "وہ فعل جو کسی چیز کی حالت کو ظاہر کرے اور اسے کسی مفعول کی ضرورت نہ ہو بلکہ خبر کی ضرورت ہو"], correctOptionIndex: 3, explanation: "فعل ناقص وہ فعل ہے جو کسی حالت کو ظاہر کرے اور خبر کا محتاج ہو، جیسے 'ہونا'، 'تھا'، 'ہے' (صفحہ 1222)." },
                    { question: "درج ذیل میں سے کون سا جملہ 'فعل ناقص' کی مثال ہے؟", options: ["احمد کھانا کھاتا ہے۔", "بچہ سو رہا ہے۔", "وہ ایک ذہین طالب علم ہے۔", "اسلم سکول گیا۔"], correctOptionIndex: 2, explanation: "'وہ ایک ذہین طالب علم ہے' میں 'ہے' فعل ناقص ہے جو طالب علم کی حالت کو ظاہر کر رہا ہے (صفحہ 1223)." },
                    { question: "اردو قواعد میں 'فعل تام' سے کیا مراد ہے؟", options: ["وہ فعل جو کسی حالت کو ظاہر کرے", "وہ فعل جو کسی کام کے ہونے یا نہ ہونے کو مکمل طور پر ظاہر کرے اور فاعل اور بعض اوقات مفعول کا محتاج ہو", "وہ فعل جو صرف خبر کا محتاج ہو", "وہ فعل جو کسی چیز کی تعریف کرے"], correctOptionIndex: 1, explanation: "فعل تام وہ فعل ہے جو اپنے معنی پورے کرنے کے لیے فاعل اور بعض اوقات مفعول کا محتاج ہو، جیسے 'لکھنا'، 'پڑھنا' (صفحہ 1224)." },
                    { question: "درج ذیل میں سے کون سا جملہ 'فعل تام' کی مثال ہے؟", options: ["میں بیمار ہوں۔", "کتاب میز پر ہے۔", "علی نے خط لکھا۔", "وہ خوش ہے۔"], correctOptionIndex: 2, explanation: "'علی نے خط لکھا' میں 'لکھا' فعل تام ہے جو کام کے مکمل ہونے کو ظاہر کر رہا ہے (صفحہ 1225)." },
                    { question: "اردو قواعد میں 'لازم' اور 'متعدی' فعل کی تعریف کیا ہے؟", options: ["لازم وہ جو مفعول چاہے، متعدی وہ جو نہ چاہے", "لازم وہ جو فاعل چاہے، متعدی وہ جو مفعول چاہے", "لازم وہ فعل جسے مفعول کی ضرورت نہ ہو، متعدی وہ فعل جسے مفعول کی ضرورت ہو", "لازم وہ جو کام مکمل نہ کرے، متعدی جو مکمل کرے"], correctOptionIndex: 2, explanation: "لازم فعل صرف فاعل پر ختم ہو جاتا ہے، جبکہ متعدی فعل کو مفعول کی ضرورت ہوتی ہے (صفحہ 1226)." }
                ];
                originalQuizQuestions.push(...urduMCQs);

                // Islamiat (5 MCQs from Pages 1352-1393)
                const islamiatMCQs = [
                    { question: "قرآن مجید کی سب سے پہلی وحی کس سورت کی ابتدائی آیات پر مشتمل تھی؟", options: ["سورۃ الفاتحہ", "سورۃ البقرہ", "سورۃ العلق", "سورۃ الکوثر"], correctOptionIndex: 2, explanation: "پہلی وحی غار حرا میں سورۃ العلق کی ابتدائی پانچ آیات تھیں (صفحہ 1352)." },
                    { question: "حج کا رکن اعظم کیا ہے؟", options: ["طواف کعبہ", "سعی بین الصفا والمروہ", "وقوف عرفہ", "رمی جمرات"], correctOptionIndex: 2, explanation: "وقوف عرفات حج کا سب سے بڑا اور بنیادی رکن ہے، اس کے بغیر حج مکمل نہیں ہوتا (صفحہ 1353)." },
                    { question: "زکوٰۃ کس پر فرض ہے؟", options: ["ہر مسلمان پر", "صرف مردوں پر", "صاحب نصاب مسلمان پر", "صرف غریبوں پر"], correctOptionIndex: 2, explanation: "زکوٰۃ ہر اس مسلمان پر فرض ہے جو نصاب کو پہنچ جائے (صفحہ 1354)." },
                    { question: "نماز کی کتنی رکعات فرض ہیں؟", options: ["12", "15", "17", "20"], correctOptionIndex: 2, explanation: "دن میں پانچ وقت کی نمازوں میں کل 17 رکعات فرض ہیں (فجر 2، ظہر 4، عصر 4، مغرب 3، عشاء 4) (صفحہ 1355)." },
                    { question: "اسلام میں سب سے پہلا غزوہ کون سا تھا؟", options: ["غزوہ احد", "غزوہ خندق", "غزوہ بدر", "غزوہ خیبر"], correctOptionIndex: 2, explanation: "غزوہ بدر سن 2 ہجری میں ہوا، جو مسلمانوں کا پہلا باقاعدہ جنگی مقابلہ تھا (صفحہ 1356)." }
                ];
                originalQuizQuestions.push(...islamiatMCQs);

                // Arabic (5 MCQs from Pages 1338-1455, specifically after 1425)
                const arabicMCQs = [
                    { question: "عربی میں 'قَلَمٌ' کا کیا مطلب ہے؟", options: ["کتاب", "کاپی", "قلم", "میز"], correctOptionIndex: 2, explanation: "قَلَمٌ کا مطلب قلم ہے (صفحہ 1426)." },
                    { question: "عربی میں 'مَکْتَبٌ' کا کیا مطلب ہے؟", options: ["کمرہ", "کرسی", "میز", "کتاب"], correctOptionIndex: 2, explanation: "مَکْتَبٌ کا مطلب میز ہے (صفحہ 1427)." },
                    { question: "عربی میں 'بابٌ' کا کیا مطلب ہے؟", options: ["کھڑکی", "دروازہ", "دیوار", "چھت"], correctOptionIndex: 1, explanation: "بابٌ کا مطلب دروازہ ہے (صفحہ 1428)." },
                    { question: "عربی میں 'نَافِذَةٌ' کا کیا مطلب ہے؟", options: ["دروازہ", "کھڑکی", "میز", "کتاب"], correctOptionIndex: 1, explanation: "نَافِذَةٌ کا مطلب کھڑکی ہے (صفحہ 1429)." },
                    { question: "عربی میں 'کُرْسِیٌّ' کا کیا مطلب ہے؟", options: ["میز", "کتاب", "کرسی", "قلم"], correctOptionIndex: 2, explanation: "کُرْسِیٌّ کا مطلب کرسی ہے (صفحہ 1430)." }
                ];
                originalQuizQuestions.push(...arabicMCQs);

                // Randomly select one special question from the entire set on initial load
                // and store its ORIGINAL index. This ensures the same question is 'special'
                // across quiz restarts unless the data is explicitly reloaded.
                specialQuestionOriginalIndex = Math.floor(Math.random() * originalQuizQuestions.length);
            }

            // Create a fresh copy of questions for the current quiz attempt
            quizQuestions = JSON.parse(JSON.stringify(originalQuizQuestions));

            // Mark the special question in the current quizQuestions array
            quizQuestions[specialQuestionOriginalIndex].special = true;

            // Shuffle the entire quiz question order
            shuffleArray(quizQuestions);

            // After shuffling, update the 'special' flag if the original special question
            // is still in the quiz and ensure its .special property is true.
            // This loop is mostly for safety and to re-verify the flag after shuffle.
            quizQuestions.forEach((q, index) => {
                if (q.special && index !== specialQuestionOriginalIndex) {
                    // If a question was marked special but its index changed due to shuffle,
                    // we need to make sure the one originally picked remains special.
                    // This logic ensures only one question is truly special for the day.
                    q.special = false; // Unmark if it's not the original special question
                }
            });
            // Re-mark the correct special question in the shuffled array
            // Find the special question in the newly shuffled array
            const currentSpecialQuestion = quizQuestions.find(q => q.special);
            if (currentSpecialQuestion) {
                 // The special question is already marked `true` from the shallow copy.
                 // This ensures the correct, originally-picked special question keeps its flag.
            } else {
                // If by some very rare chance (e.g., if a special question was not initially marked, which it is),
                // or if the `find` fails, pick one again. This is a fallback.
                const newSpecialIndex = Math.floor(Math.random() * quizQuestions.length);
                quizQuestions[newSpecialIndex].special = true;
                specialQuestionOriginalIndex = originalQuizQuestions.findIndex(q => JSON.stringify(q) === JSON.stringify(quizQuestions[newSpecialIndex]));
            }
        }

        // Load MathJax for rendering LaTeX
        const script = document.createElement('script');
        script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
        script.async = true;
        document.head.appendChild(script);

        // Initialize the quiz when the script loads
        initializeQuiz();
        // Explicitly show the login page after initialization to prevent any display issues
        showPage('loginPage');
    </script>
</body>
</html>
